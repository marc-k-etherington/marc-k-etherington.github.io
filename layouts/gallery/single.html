{{ define "main" }}

<!-- Hero Banner -->
{{ partial "hero-banner.html" . }}

<h1>{{ .Title }}</h1>

<!-- Gallery Hero Image -->
{{ if .Params.hero_image }}
<div class="gallery-hero">
  <img src="{{ .Params.hero_image }}" alt="{{ .Params.hero_caption | default "Gallery" }}" class="gallery-hero-img">
  {{ if .Params.hero_caption }}
  <div class="gallery-hero-caption">{{ .Params.hero_caption }}</div>
  {{ end }}
</div>
{{ end }}
<p class="intro">{{ .Params.subtitle | default "Moments from the lab, conferences, and adventures" }}</p>

<!-- Filter Buttons -->
<div class="gallery-filters">
  <button class="gallery-filter-btn active" onclick="filterGallery('all')">All Photos</button>
  <button class="gallery-filter-btn" onclick="filterGallery('lab')">Lab Life</button>
  <button class="gallery-filter-btn" onclick="filterGallery('conferences')">Conferences</button>
  <button class="gallery-filter-btn" onclick="filterGallery('social')">Social</button>
  <button class="gallery-filter-btn" onclick="filterGallery('travel')">Travel</button>
</div>

<!-- Travel Filter Instagram Banner (Hidden by default) -->
<div id="travel-instagram-banner" class="travel-banner" style="display: none; text-align: center; margin: 1.5rem auto; padding: 1.5rem; background: linear-gradient(135deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%); border-radius: 12px; max-width: 700px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
  <p style="color: white; font-size: 1.1rem; margin: 0 0 0.8rem 0; font-weight: 500;">
    âœˆï¸ Love travel photos from conferences and research visits?
  </p>
  <a href="https://www.instagram.com/mketherington" target="_blank" rel="noopener" 
     style="display: inline-block; background: white; color: #E1306C; padding: 0.7rem 1.5rem; border-radius: 8px; text-decoration: none; font-weight: 600; transition: transform 0.2s;">
    Follow @mketherington on Instagram â†’
  </a>
</div>

<!-- Corkboard Container -->
<div class="scrapbook-container">
  <div class="scrapbook" id="scrapbook-grid">
    
    {{ $photos := .Params.photos }}
    {{ $decorativeFrequency := 4 }}
    
    {{ range $index, $photo := $photos }}
      
      <!-- Insert decorative item every 4th position -->
      {{ if and (gt $index 0) (eq (mod $index $decorativeFrequency) 0) }}
        {{ $decorType := mod (div $index $decorativeFrequency) 4 }}
        
        {{ if eq $decorType 0 }}
          <!-- Sticky Note -->
          <div class="decorative-item">
            <div class="sticky-note" style="--rotation: {{ sub 0 (mod $index 15) }}deg; background: {{ index (slice "linear-gradient(135deg, #ffeb3b 0%, #ffd700 100%)" "linear-gradient(135deg, #a8e6cf 0%, #7bc9a3 100%)" "linear-gradient(135deg, #ffb3ba 0%, #ff8a9a 100%)" "linear-gradient(135deg, #ffd4a3 0%, #ffb347 100%)") (mod $index 4) }};">
              {{ index (slice "TADF Research\nâš¡" "Beyond the\nsingle molecule\nğŸ“š" "Nature Comms\n2016 & 2017\nğŸŒŸ" "Spin-vibronic\ncoupling\nâš—ï¸") (mod $index 4) }}
            </div>
          </div>
        {{ else if eq $decorType 1 }}
          <!-- Icon -->
          <div class="decorative-item">
            <div class="cork-item" style="--rotation: {{ mod $index 30 }}deg;">
              {{ index (slice "ğŸ§ª" "ğŸ”¬" "âš—ï¸" "ğŸ’¡" "ğŸ“Š" "ğŸ¯" "ğŸ“") (mod $index 7) }}
            </div>
          </div>
        {{ else if eq $decorType 2 }}
          <!-- Business Card -->
          <div class="decorative-item">
            <div class="business-card" style="--rotation: {{ sub 0 (mod $index 12) }}deg;">
              <strong>The Etherington Lab</strong>
              Organic Photonics & TADF<br>
              Northumbria University<br>
              Newcastle upon Tyne<br>
              ğŸ”¬ Spectroscopy â€¢ Photophysics
            </div>
          </div>
        {{ else }}
          <!-- Another sticky note -->
          <div class="decorative-item">
            <div class="sticky-note" style="--rotation: {{ mod $index 20 }}deg; background: {{ index (slice "linear-gradient(135deg, #c5e1a5 0%, #aed581 100%)" "linear-gradient(135deg, #e1bee7 0%, #ce93d8 100%)" "linear-gradient(135deg, #ffccbc 0%, #ffab91 100%)") (mod $index 3) }};">
              {{ index (slice "Low temp\nmeasurements\nğŸ“‰" "Conference\nseason!\nâœˆï¸" "New results!\nğŸ‰") (mod $index 3) }}
            </div>
          </div>
        {{ end }}
      {{ end }}
      
      <!-- Photo Polaroid -->
      <!-- Handle both single category (string) and multiple categories (array) -->
      {{ $categoryData := "" }}
      {{ if reflect.IsSlice $photo.categories }}
        {{ $categoryData = delimit $photo.categories "," }}
      {{ else if $photo.category }}
        {{ $categoryData = $photo.category }}
      {{ else if $photo.categories }}
        {{ $categoryData = $photo.categories }}
      {{ end }}
      
      {{ if $photo.link }}
        <a href="{{ $photo.link }}" class="polaroid clickable {{ $photo.decoration }}" data-category="{{ $categoryData }}">
          <img src="{{ $photo.image }}" alt="{{ $photo.caption }}" class="polaroid-photo">
          <div class="polaroid-caption">{{ $photo.caption }}</div>
        </a>
      {{ else }}
        <div class="polaroid {{ $photo.decoration }}" data-category="{{ $categoryData }}">
          <img src="{{ $photo.image }}" alt="{{ $photo.caption }}" class="polaroid-photo">
          <div class="polaroid-caption">{{ $photo.caption }}</div>
        </div>
      {{ end }}
      
    {{ end }}
    
  </div>
</div>

<!-- Instagram Link -->
<p class="gallery-note" style="text-align: center; margin: 3rem auto 2rem; max-width: 600px; color: #666; font-size: 0.95rem;">
  Looking for more travel photos from conferences and research visits? 
  <a href="https://www.instagram.com/mketherington" target="_blank" rel="noopener" style="color: #E1306C; text-decoration: none; font-weight: 500;">Follow me on Instagram â†’</a>
</p>

<!-- Back to Top Button -->
<button class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">â†‘ Top</button>

<!-- Floating Social Media -->
<div class="social-float-compact">
  <a href="https://www.linkedin.com/in/marc-kenneth-etherington-32aa5876/" target="_blank" rel="noopener" title="LinkedIn">
    <img src="/images/LinkedIn.jpg" alt="LinkedIn" class="social-icon">
  </a>
  <a href="https://bsky.app/profile/mketherington.bsky.social" target="_blank" rel="noopener" title="Bluesky">
    <img src="/images/BlueSky_Logo.png" alt="Bluesky" class="social-icon">
  </a>
  <a href="https://www.researchgate.net/profile/Marc-Etherington?ev=hdr_xprf" target="_blank" rel="noopener" title="ResearchGate">
    <img src="/images/Researchgate.png" alt="ResearchGate" class="social-icon">
  </a>
  <a href="https://scholar.google.co.uk/citations?user=3dgABIQAAAAJ&hl=en" target="_blank" rel="noopener" title="Google Scholar">
    <img src="/images/Google_Scholar.png" alt="Google Scholar" class="social-icon">
  </a>
</div>

<script>
function filterGallery(category) {
  const polaroids = document.querySelectorAll('.polaroid');
  const decoratives = document.querySelectorAll('.decorative-item');
  const buttons = document.querySelectorAll('.gallery-filter-btn');
  const travelBanner = document.getElementById('travel-instagram-banner');
  
  // Update active button
  buttons.forEach(btn => btn.classList.remove('active'));
  event.target.classList.add('active');
  
  // Show/hide polaroids
  polaroids.forEach(polaroid => {
    const categoryData = polaroid.getAttribute('data-category');
    
    // Handle both single category and multiple categories (comma-separated)
    const photoCategories = categoryData ? categoryData.split(',').map(c => c.trim()) : [];
    
    if (category === 'all' || photoCategories.includes(category)) {
      polaroid.style.display = 'block';
    } else {
      polaroid.style.display = 'none';
    }
  });
  
  // Show decorative items only when "all" is selected
  decoratives.forEach(item => {
    item.style.display = category === 'all' ? 'flex' : 'none';
  });
  
  // Show Instagram banner only when "travel" filter is active
  if (travelBanner) {
    travelBanner.style.display = category === 'travel' ? 'block' : 'none';
  }
}
</script>

{{ end }}